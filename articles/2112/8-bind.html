<h1 class="style1c">【JavaScriptの応用】bindメソッドを使ってthisを束縛する方法。call/applyメソッドとの違いも解説</h1>
<p>thisの値を指定することができるbindメソッド。
bindという名前の通り、thisを束縛するために利用されます。</p>
<p>今回は、thisを自由に制御するために便利なbindメソッドについて解説と、類似のcall/applyメソッドとの違いについて取り上げます。</p>
<h2 class="style2c">bindメソッドとは</h2>
<p>「bindメソッド」とは、thisの値を束縛し、新しい関数を生成するためのメソッドです。
「thisの束縛」以外にも、「関数の紐付け」などど表現されることがあります。</p>
<p>bindメソッドが呼ばれると、関数を実行するのではなく、与えられたthisの値を持った新しい関数を生成するというのが特徴です。</p>
<h2 class="style2c">bindメソッドの使い方</h2>
<p>では、具体的にbindメソッドの使い方を見ていきましょう。</p>
<h3 class="style3c">bindメソッドの基本構文</h3>
<p>以下は、bindメソッドの基本構文です。
第1引数にthisの値を指定し、第2引数以降には紐付けたい関数の引数を指定します。</p>

        <div class="hcb_wrap">
        <pre class="prism undefined-numbers lang-js" data-lang="JavaScript"><code>関数.bind(thisの値, ...関数の引数);
</code></pre>
        </div>
        
<h3 class="style3c">bindメソッドの役割</h3>
<p>bindメソッドを実際に使ってみると、以下のように書くことができます。</p>

        <div class="hcb_wrap">
        <pre class="prism undefined-numbers lang-js" data-lang="JavaScript"><code>let user = {
    name: 'Tarou'
};

function greeting(message) {
    return `${message}, ${this.name}!`;
}

//関数greetingをラップした新しい関数（getUser）を作る
const getUser = greeting.bind(user, 'Hello');
console.log(getUser()); //"Hello, Tarou!"
</code></pre>
        </div>
        
<p>関数greetingでは、thisがuserオブジェクトに束縛され、さらにbindメソッドによって関数greetingがラップされた新しい関数が生成されています。</p>
<p>上記で取り上げた例を単純な関数で表現するとこのようになります。</p>

        <div class="hcb_wrap">
        <pre class="prism undefined-numbers lang-js" data-lang="JavaScript"><code>let user = {
    name: 'Tarou'
};

function greeting(message) {
    return `${message}, ${this.name}!`;
}

//bindメソッドを使うと、以下のような元の関数をラップする新しい関数を作る
const getUser = () =&gt; {
    return greeting.call(user, 'Hello');
};

console.log(getUser()); //"Hello, Tarou!"
</code></pre>
        </div>
        
<p>いかがでしょうか。
bindメソッドは、thisやその他の引数を束縛した関数を作る役割があることが分かります。</p>
<h2 class="style2c">call/applyメソッドとの違い</h2>
<p>bindメソッドは、call/applyメソッドと混同されがちですが、異なる動きを持っています。</p>
<p>以下を見ながらbindメソッドとcallメソッドの動きを比べてみましょう。</p>

        <div class="hcb_wrap">
        <pre class="prism undefined-numbers lang-js" data-lang="JavaScript"><code>//bindメソッドのパターン
let user = {
    name: 'Tarou',
    greeting: function() {
        console.log(`Hello, ${this.name}!`);
    }
};

const sayHi = user.greeting.bind(user); //thisを束縛した関数sayHiを作る
sayHi(); //"Hello, Tarou!"
setTimeout(sayHi, 2000); //"Hello, Tarou!" 2秒後に関数sayHiが実行される


//callメソッドのパターン(applyメソッドも同様)
let user = {
    name: 'Tarou',
    greeting: function() {
        console.log(`Hello, ${this.name}!`);
    }
};

const sayHi = user.greeting.call(user); //"Hello, Tarou!" ここでthisを指定した関数greetingが実行される
sayHi(); //"Uncaught TypeError: sayHi is not a function"
</code></pre>
        </div>
        
<p>bind/call/applyメソッドを使うと、thisの値を指定することができるという点は同じです。
しかし、call/applyメソッドの場合は、メソッドが呼ばれた瞬時に元の関数が実行されるのに対して、bindメソッドは、メソッドが呼ばれたと同時に新しい関数を作り、新しい関数にthisや引数の値を引継ぎます。
call/applyは、新しい関数を作成するわけではないため、関数sayHiを実行しても関数として認識されずエラーとなります。</p>
<h2 class="style2c">まとめ</h2>
<p>今回は、bindメソッドの役割と類似のcall/applyメソッドとの違いについて解説しました。</p>
<p>bindメソッドと使うと、thisの値を固定化し、thisや引数を新しい関数へ紐付けができるようになります。
call/applyメソッドと似たような役割がありますが、まずは、「thisを束縛して新しい関数を作るのがbindメソッド」と覚えておくと良いでしょう。</p>
<p>bindメソッドをうまく活用して、thisを自由自在に使えるように実践していきましょう。</p>
<h3 class="style3c">JavaScript関連記事</h3>
<p>[clink url="https://tcd-theme.com/2021/12/javascript-this.html"]
[clink url="https://tcd-theme.com/2021/12/javascript-call-apply.html"]</p>


